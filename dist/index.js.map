{"version":3,"sources":["../src/index.js"],"names":["calculatePasswordScore","password","score","hasMinimumLength","length","hasMaximumLength","isCommonPassword","commonPasswords","includes","validate","errors","push","isValid"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,IAAMA,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAAC,QAAQ;AAAA,SAAI,qBAAOA,QAAP,EAAiBC,KAArB;AAAA,CAAvC;;AAEA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACF,QAAD;AAAA,MAAWG,MAAX,uEAAoB,CAApB;AAAA,SACtBH,QAAQ,CAACG,MAAT,IAAmBA,MADG;AAAA,CAAzB;;AAGA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACJ,QAAD;AAAA,MAAWG,MAAX,uEAAoB,EAApB;AAAA,SACtBH,QAAQ,CAACG,MAAT,IAAmBA,MADG;AAAA,CAAzB;;AAGA,IAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAAL,QAAQ;AAAA,SAAIM,yBAAgBC,QAAhB,CAAyBP,QAAzB,CAAJ;AAAA,CAAjC;;AAEO,IAAMQ,QAAQ,GAAG,SAAXA,QAAW,CAACR,QAAD,EAAc;AAAE;AACtC,MAAMS,MAAM,GAAG,EAAf;;AAEA,MAAI,CAACL,gBAAgB,CAACJ,QAAD,CAArB,EAAiC;AAC/BS,IAAAA,MAAM,CAACC,IAAP,CAAY,YAAZ;AACD;;AAED,MAAI,CAACR,gBAAgB,CAACF,QAAD,CAArB,EAAiC;AAC/BS,IAAAA,MAAM,CAACC,IAAP,CAAY,YAAZ;AACD;;AAED,MAAIL,gBAAgB,CAACL,QAAD,CAApB,EAAgC;AAC9BS,IAAAA,MAAM,CAACC,IAAP,CAAY,iBAAZ;AACD;;AAED,SAAO;AACLC,IAAAA,OAAO,EAAGF,MAAM,CAACN,MAAP,KAAkB,CADvB;AAELM,IAAAA,MAAM,EAANA,MAFK;AAGLR,IAAAA,KAAK,EAAEF,sBAAsB,CAACC,QAAD;AAHxB,GAAP;AAKD,CApBM","sourcesContent":["import zxcvbn from 'zxcvbn'\nimport commonPasswords from './common-passwords'\n\nconst calculatePasswordScore = password => zxcvbn(password).score\n\nconst hasMinimumLength = (password, length = 8) =>\n  (password.length >= length)\n\nconst hasMaximumLength = (password, length = 64) =>\n  (password.length <= length)\n\nconst isCommonPassword = password => commonPasswords.includes(password)\n\nexport const validate = (password) => { // eslint-disable-line import/prefer-default-export\n  const errors = []\n\n  if (!hasMaximumLength(password)) {\n    errors.push('max_length')\n  }\n\n  if (!hasMinimumLength(password)) {\n    errors.push('min_length')\n  }\n\n  if (isCommonPassword(password)) {\n    errors.push('commom_password')\n  }\n\n  return {\n    isValid: (errors.length === 0),\n    errors,\n    score: calculatePasswordScore(password),\n  }\n}\n"],"file":"index.js"}